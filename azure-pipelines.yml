jobs:


### recipes/alpine_jdk8/Dockerfile eclipse/alpine_jdk8 depends on openjdk:8u111-jre-alpine openjdk/8u111-jre-alpine
  - job: "recipes__alpine_jdk8__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/alpine_jdk8
        if [[ $? == 0 ]]; then
          docker tag eclipse/alpine_jdk8 eclipse/alpine_jdk8
        else
          docker pull eclipse/alpine_jdk8
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/alpine_jdk8
        fi
        docker pull openjdk:8u111-jre-alpine
        if [[ $? == 0 ]]; then
          docker tag openjdk:8u111-jre-alpine openjdk:8u111-jre-alpine
        else
          docker pull openjdk:8u111-jre-alpine
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch openjdk:8u111-jre-alpine
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/alpine_jdk8 =~ stack-base ]]; then
          docker build -f recipes/alpine_jdk8/Dockerfile -t eclipse/alpine_jdk8 recipes/alpine_jdk8
        else
          docker build -f recipes/alpine_jdk8/Dockerfile --cache-from eclipse/alpine_jdk8 -t eclipse/alpine_jdk8 recipes/alpine_jdk8
        fi
      displayName: "Building eclipse/alpine_jdk8"
    - script: docker push eclipse/alpine_jdk8
      displayName: "Pushing eclipse/alpine_jdk8"

### recipes/android/Dockerfile eclipse/android depends on eclipse/stack-base:centos recipes/stack-base/centos
  - job: "recipes__android__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__stack__base__centos__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/android
        if [[ $? == 0 ]]; then
          docker tag eclipse/android eclipse/android
        else
          docker pull eclipse/android
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/android
        fi
        docker pull eclipse/stack-base:centos
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:centos eclipse/stack-base:centos
        else
          docker pull eclipse/stack-base:centos
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:centos
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/android =~ stack-base ]]; then
          docker build -f recipes/android/Dockerfile -t eclipse/android recipes/android
        else
          docker build -f recipes/android/Dockerfile --cache-from eclipse/android -t eclipse/android recipes/android
        fi
      displayName: "Building eclipse/android"
    - script: docker push eclipse/android
      displayName: "Pushing eclipse/android"

### recipes/angular/Dockerfile eclipse/angular depends on eclipse/node recipes/node
  - job: "recipes__angular__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__node__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/angular
        if [[ $? == 0 ]]; then
          docker tag eclipse/angular eclipse/angular
        else
          docker pull eclipse/angular
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/angular
        fi
        docker pull eclipse/node
        if [[ $? == 0 ]]; then
          docker tag eclipse/node eclipse/node
        else
          docker pull eclipse/node
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/node
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/angular =~ stack-base ]]; then
          docker build -f recipes/angular/Dockerfile -t eclipse/angular recipes/angular
        else
          docker build -f recipes/angular/Dockerfile --cache-from eclipse/angular -t eclipse/angular recipes/angular
        fi
      displayName: "Building eclipse/angular"
    - script: docker push eclipse/angular
      displayName: "Pushing eclipse/angular"

### recipes/centos_ceylon_nodejs_dart/Dockerfile eclipse/centos_ceylon_nodejs_dart depends on registry.centos.org/che-stacks/centos-jdk8 registry.centos.org/che-stacks/centos-jdk8
  - job: "recipes__centos_ceylon_nodejs_dart__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/centos_ceylon_nodejs_dart
        if [[ $? == 0 ]]; then
          docker tag eclipse/centos_ceylon_nodejs_dart eclipse/centos_ceylon_nodejs_dart
        else
          docker pull eclipse/centos_ceylon_nodejs_dart
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/centos_ceylon_nodejs_dart
        fi
        docker pull registry.centos.org/che-stacks/centos-jdk8
        if [[ $? == 0 ]]; then
          docker tag registry.centos.org/che-stacks/centos-jdk8 registry.centos.org/che-stacks/centos-jdk8
        else
          docker pull registry.centos.org/che-stacks/centos-jdk8
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch registry.centos.org/che-stacks/centos-jdk8
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/centos_ceylon_nodejs_dart =~ stack-base ]]; then
          docker build -f recipes/centos_ceylon_nodejs_dart/Dockerfile -t eclipse/centos_ceylon_nodejs_dart recipes/centos_ceylon_nodejs_dart
        else
          docker build -f recipes/centos_ceylon_nodejs_dart/Dockerfile --cache-from eclipse/centos_ceylon_nodejs_dart -t eclipse/centos_ceylon_nodejs_dart recipes/centos_ceylon_nodejs_dart
        fi
      displayName: "Building eclipse/centos_ceylon_nodejs_dart"
    - script: docker push eclipse/centos_ceylon_nodejs_dart
      displayName: "Pushing eclipse/centos_ceylon_nodejs_dart"

### recipes/centos_dotnet20/Dockerfile eclipse/centos_dotnet20 depends on registry.centos.org/che-stacks/centos-stack-base:latest registry.centos.org/che-stacks/centos-stack-base/latest
  - job: "recipes__centos_dotnet20__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/centos_dotnet20
        if [[ $? == 0 ]]; then
          docker tag eclipse/centos_dotnet20 eclipse/centos_dotnet20
        else
          docker pull eclipse/centos_dotnet20
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/centos_dotnet20
        fi
        docker pull registry.centos.org/che-stacks/centos-stack-base:latest
        if [[ $? == 0 ]]; then
          docker tag registry.centos.org/che-stacks/centos-stack-base:latest registry.centos.org/che-stacks/centos-stack-base:latest
        else
          docker pull registry.centos.org/che-stacks/centos-stack-base:latest
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch registry.centos.org/che-stacks/centos-stack-base:latest
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/centos_dotnet20 =~ stack-base ]]; then
          docker build -f recipes/centos_dotnet20/Dockerfile -t eclipse/centos_dotnet20 recipes/centos_dotnet20
        else
          docker build -f recipes/centos_dotnet20/Dockerfile --cache-from eclipse/centos_dotnet20 -t eclipse/centos_dotnet20 recipes/centos_dotnet20
        fi
      displayName: "Building eclipse/centos_dotnet20"
    - script: docker push eclipse/centos_dotnet20
      displayName: "Pushing eclipse/centos_dotnet20"

### recipes/centos_go/Dockerfile eclipse/centos_go depends on registry.centos.org/che-stacks/centos-nodejs registry.centos.org/che-stacks/centos-nodejs
  - job: "recipes__centos_go__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/centos_go
        if [[ $? == 0 ]]; then
          docker tag eclipse/centos_go eclipse/centos_go
        else
          docker pull eclipse/centos_go
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/centos_go
        fi
        docker pull registry.centos.org/che-stacks/centos-nodejs
        if [[ $? == 0 ]]; then
          docker tag registry.centos.org/che-stacks/centos-nodejs registry.centos.org/che-stacks/centos-nodejs
        else
          docker pull registry.centos.org/che-stacks/centos-nodejs
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch registry.centos.org/che-stacks/centos-nodejs
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/centos_go =~ stack-base ]]; then
          docker build -f recipes/centos_go/Dockerfile -t eclipse/centos_go recipes/centos_go
        else
          docker build -f recipes/centos_go/Dockerfile --cache-from eclipse/centos_go -t eclipse/centos_go recipes/centos_go
        fi
      displayName: "Building eclipse/centos_go"
    - script: docker push eclipse/centos_go
      displayName: "Pushing eclipse/centos_go"

### recipes/centos_jdk8/Dockerfile eclipse/centos_jdk8 depends on registry.centos.org/che-stacks/centos-stack-base registry.centos.org/che-stacks/centos-stack-base
  - job: "recipes__centos_jdk8__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/centos_jdk8
        if [[ $? == 0 ]]; then
          docker tag eclipse/centos_jdk8 eclipse/centos_jdk8
        else
          docker pull eclipse/centos_jdk8
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/centos_jdk8
        fi
        docker pull registry.centos.org/che-stacks/centos-stack-base
        if [[ $? == 0 ]]; then
          docker tag registry.centos.org/che-stacks/centos-stack-base registry.centos.org/che-stacks/centos-stack-base
        else
          docker pull registry.centos.org/che-stacks/centos-stack-base
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch registry.centos.org/che-stacks/centos-stack-base
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/centos_jdk8 =~ stack-base ]]; then
          docker build -f recipes/centos_jdk8/Dockerfile -t eclipse/centos_jdk8 recipes/centos_jdk8
        else
          docker build -f recipes/centos_jdk8/Dockerfile --cache-from eclipse/centos_jdk8 -t eclipse/centos_jdk8 recipes/centos_jdk8
        fi
      displayName: "Building eclipse/centos_jdk8"
    - script: docker push eclipse/centos_jdk8
      displayName: "Pushing eclipse/centos_jdk8"

### recipes/centos_nodejs/Dockerfile eclipse/centos_nodejs depends on registry.centos.org/che-stacks/centos-stack-base registry.centos.org/che-stacks/centos-stack-base
  - job: "recipes__centos_nodejs__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/centos_nodejs
        if [[ $? == 0 ]]; then
          docker tag eclipse/centos_nodejs eclipse/centos_nodejs
        else
          docker pull eclipse/centos_nodejs
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/centos_nodejs
        fi
        docker pull registry.centos.org/che-stacks/centos-stack-base
        if [[ $? == 0 ]]; then
          docker tag registry.centos.org/che-stacks/centos-stack-base registry.centos.org/che-stacks/centos-stack-base
        else
          docker pull registry.centos.org/che-stacks/centos-stack-base
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch registry.centos.org/che-stacks/centos-stack-base
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/centos_nodejs =~ stack-base ]]; then
          docker build -f recipes/centos_nodejs/Dockerfile -t eclipse/centos_nodejs recipes/centos_nodejs
        else
          docker build -f recipes/centos_nodejs/Dockerfile --cache-from eclipse/centos_nodejs -t eclipse/centos_nodejs recipes/centos_nodejs
        fi
      displayName: "Building eclipse/centos_nodejs"
    - script: docker push eclipse/centos_nodejs
      displayName: "Pushing eclipse/centos_nodejs"

### recipes/centos_python/2/Dockerfile eclipse/centos_python:2 depends on registry.centos.org/che-stacks/centos-stack-base registry.centos.org/che-stacks/centos-stack-base
  - job: "recipes__centos_python__2__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/centos_python:2
        if [[ $? == 0 ]]; then
          docker tag eclipse/centos_python:2 eclipse/centos_python:2
        else
          docker pull eclipse/centos_python:2
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/centos_python:2
        fi
        docker pull registry.centos.org/che-stacks/centos-stack-base
        if [[ $? == 0 ]]; then
          docker tag registry.centos.org/che-stacks/centos-stack-base registry.centos.org/che-stacks/centos-stack-base
        else
          docker pull registry.centos.org/che-stacks/centos-stack-base
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch registry.centos.org/che-stacks/centos-stack-base
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/centos_python:2 =~ stack-base ]]; then
          docker build -f recipes/centos_python/2/Dockerfile -t eclipse/centos_python:2 recipes/centos_python/2
        else
          docker build -f recipes/centos_python/2/Dockerfile --cache-from eclipse/centos_python:2 -t eclipse/centos_python:2 recipes/centos_python/2
        fi
      displayName: "Building eclipse/centos_python:2"
    - script: docker push eclipse/centos_python:2
      displayName: "Pushing eclipse/centos_python:2"

### recipes/centos_python/3/Dockerfile eclipse/centos_python:3 depends on registry.centos.org/che-stacks/centos-stack-base registry.centos.org/che-stacks/centos-stack-base
  - job: "recipes__centos_python__3__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/centos_python:3
        if [[ $? == 0 ]]; then
          docker tag eclipse/centos_python:3 eclipse/centos_python:3
        else
          docker pull eclipse/centos_python:3
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/centos_python:3
        fi
        docker pull registry.centos.org/che-stacks/centos-stack-base
        if [[ $? == 0 ]]; then
          docker tag registry.centos.org/che-stacks/centos-stack-base registry.centos.org/che-stacks/centos-stack-base
        else
          docker pull registry.centos.org/che-stacks/centos-stack-base
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch registry.centos.org/che-stacks/centos-stack-base
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/centos_python:3 =~ stack-base ]]; then
          docker build -f recipes/centos_python/3/Dockerfile -t eclipse/centos_python:3 recipes/centos_python/3
        else
          docker build -f recipes/centos_python/3/Dockerfile --cache-from eclipse/centos_python:3 -t eclipse/centos_python:3 recipes/centos_python/3
        fi
      displayName: "Building eclipse/centos_python:3"
    - script: docker push eclipse/centos_python:3
      displayName: "Pushing eclipse/centos_python:3"

### recipes/centos_spring_boot/Dockerfile eclipse/centos_spring_boot depends on registry.centos.org/che-stacks/centos-jdk8 registry.centos.org/che-stacks/centos-jdk8
  - job: "recipes__centos_spring_boot__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/centos_spring_boot
        if [[ $? == 0 ]]; then
          docker tag eclipse/centos_spring_boot eclipse/centos_spring_boot
        else
          docker pull eclipse/centos_spring_boot
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/centos_spring_boot
        fi
        docker pull registry.centos.org/che-stacks/centos-jdk8
        if [[ $? == 0 ]]; then
          docker tag registry.centos.org/che-stacks/centos-jdk8 registry.centos.org/che-stacks/centos-jdk8
        else
          docker pull registry.centos.org/che-stacks/centos-jdk8
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch registry.centos.org/che-stacks/centos-jdk8
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/centos_spring_boot =~ stack-base ]]; then
          docker build -f recipes/centos_spring_boot/Dockerfile -t eclipse/centos_spring_boot recipes/centos_spring_boot
        else
          docker build -f recipes/centos_spring_boot/Dockerfile --cache-from eclipse/centos_spring_boot -t eclipse/centos_spring_boot recipes/centos_spring_boot
        fi
      displayName: "Building eclipse/centos_spring_boot"
    - script: docker push eclipse/centos_spring_boot
      displayName: "Pushing eclipse/centos_spring_boot"

### recipes/centos_vertx/Dockerfile eclipse/centos_vertx depends on registry.centos.org/che-stacks/centos-jdk8 registry.centos.org/che-stacks/centos-jdk8
  - job: "recipes__centos_vertx__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/centos_vertx
        if [[ $? == 0 ]]; then
          docker tag eclipse/centos_vertx eclipse/centos_vertx
        else
          docker pull eclipse/centos_vertx
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/centos_vertx
        fi
        docker pull registry.centos.org/che-stacks/centos-jdk8
        if [[ $? == 0 ]]; then
          docker tag registry.centos.org/che-stacks/centos-jdk8 registry.centos.org/che-stacks/centos-jdk8
        else
          docker pull registry.centos.org/che-stacks/centos-jdk8
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch registry.centos.org/che-stacks/centos-jdk8
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/centos_vertx =~ stack-base ]]; then
          docker build -f recipes/centos_vertx/Dockerfile -t eclipse/centos_vertx recipes/centos_vertx
        else
          docker build -f recipes/centos_vertx/Dockerfile --cache-from eclipse/centos_vertx -t eclipse/centos_vertx recipes/centos_vertx
        fi
      displayName: "Building eclipse/centos_vertx"
    - script: docker push eclipse/centos_vertx
      displayName: "Pushing eclipse/centos_vertx"

### recipes/centos_wildfly_swarm/Dockerfile eclipse/centos_wildfly_swarm depends on registry.centos.org/che-stacks/centos-jdk8 registry.centos.org/che-stacks/centos-jdk8
  - job: "recipes__centos_wildfly_swarm__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/centos_wildfly_swarm
        if [[ $? == 0 ]]; then
          docker tag eclipse/centos_wildfly_swarm eclipse/centos_wildfly_swarm
        else
          docker pull eclipse/centos_wildfly_swarm
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/centos_wildfly_swarm
        fi
        docker pull registry.centos.org/che-stacks/centos-jdk8
        if [[ $? == 0 ]]; then
          docker tag registry.centos.org/che-stacks/centos-jdk8 registry.centos.org/che-stacks/centos-jdk8
        else
          docker pull registry.centos.org/che-stacks/centos-jdk8
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch registry.centos.org/che-stacks/centos-jdk8
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/centos_wildfly_swarm =~ stack-base ]]; then
          docker build -f recipes/centos_wildfly_swarm/Dockerfile -t eclipse/centos_wildfly_swarm recipes/centos_wildfly_swarm
        else
          docker build -f recipes/centos_wildfly_swarm/Dockerfile --cache-from eclipse/centos_wildfly_swarm -t eclipse/centos_wildfly_swarm recipes/centos_wildfly_swarm
        fi
      displayName: "Building eclipse/centos_wildfly_swarm"
    - script: docker push eclipse/centos_wildfly_swarm
      displayName: "Pushing eclipse/centos_wildfly_swarm"

### recipes/cpp_gcc/Dockerfile eclipse/cpp_gcc depends on eclipse/stack-base:ubuntu recipes/stack-base/ubuntu
  - job: "recipes__cpp_gcc__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__stack__base__ubuntu__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/cpp_gcc
        if [[ $? == 0 ]]; then
          docker tag eclipse/cpp_gcc eclipse/cpp_gcc
        else
          docker pull eclipse/cpp_gcc
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/cpp_gcc
        fi
        docker pull eclipse/stack-base:ubuntu
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:ubuntu eclipse/stack-base:ubuntu
        else
          docker pull eclipse/stack-base:ubuntu
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:ubuntu
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/cpp_gcc =~ stack-base ]]; then
          docker build -f recipes/cpp_gcc/Dockerfile -t eclipse/cpp_gcc recipes/cpp_gcc
        else
          docker build -f recipes/cpp_gcc/Dockerfile --cache-from eclipse/cpp_gcc -t eclipse/cpp_gcc recipes/cpp_gcc
        fi
      displayName: "Building eclipse/cpp_gcc"
    - script: docker push eclipse/cpp_gcc
      displayName: "Pushing eclipse/cpp_gcc"

### recipes/debian_jdk8/Dockerfile eclipse/debian_jdk8 depends on eclipse/stack-base:debian recipes/stack-base/debian
  - job: "recipes__debian_jdk8__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__stack__base__debian__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/debian_jdk8
        if [[ $? == 0 ]]; then
          docker tag eclipse/debian_jdk8 eclipse/debian_jdk8
        else
          docker pull eclipse/debian_jdk8
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/debian_jdk8
        fi
        docker pull eclipse/stack-base:debian
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:debian eclipse/stack-base:debian
        else
          docker pull eclipse/stack-base:debian
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:debian
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/debian_jdk8 =~ stack-base ]]; then
          docker build -f recipes/debian_jdk8/Dockerfile -t eclipse/debian_jdk8 recipes/debian_jdk8
        else
          docker build -f recipes/debian_jdk8/Dockerfile --cache-from eclipse/debian_jdk8 -t eclipse/debian_jdk8 recipes/debian_jdk8
        fi
      displayName: "Building eclipse/debian_jdk8"
    - script: docker push eclipse/debian_jdk8
      displayName: "Pushing eclipse/debian_jdk8"

### recipes/debian_jdk8_node/Dockerfile eclipse/debian_jdk8_node depends on eclipse/debian_jdk8 recipes/debian_jdk8
  - job: "recipes__debian_jdk8_node__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__debian_jdk8__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/debian_jdk8_node
        if [[ $? == 0 ]]; then
          docker tag eclipse/debian_jdk8_node eclipse/debian_jdk8_node
        else
          docker pull eclipse/debian_jdk8_node
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/debian_jdk8_node
        fi
        docker pull eclipse/debian_jdk8
        if [[ $? == 0 ]]; then
          docker tag eclipse/debian_jdk8 eclipse/debian_jdk8
        else
          docker pull eclipse/debian_jdk8
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/debian_jdk8
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/debian_jdk8_node =~ stack-base ]]; then
          docker build -f recipes/debian_jdk8_node/Dockerfile -t eclipse/debian_jdk8_node recipes/debian_jdk8_node
        else
          docker build -f recipes/debian_jdk8_node/Dockerfile --cache-from eclipse/debian_jdk8_node -t eclipse/debian_jdk8_node recipes/debian_jdk8_node
        fi
      displayName: "Building eclipse/debian_jdk8_node"
    - script: docker push eclipse/debian_jdk8_node
      displayName: "Pushing eclipse/debian_jdk8_node"

### recipes/dotnet_core/Dockerfile eclipse/dotnet_core depends on eclipse/stack-base:ubuntu recipes/stack-base/ubuntu
  - job: "recipes__dotnet_core__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__stack__base__ubuntu__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/dotnet_core
        if [[ $? == 0 ]]; then
          docker tag eclipse/dotnet_core eclipse/dotnet_core
        else
          docker pull eclipse/dotnet_core
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/dotnet_core
        fi
        docker pull eclipse/stack-base:ubuntu
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:ubuntu eclipse/stack-base:ubuntu
        else
          docker pull eclipse/stack-base:ubuntu
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:ubuntu
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/dotnet_core =~ stack-base ]]; then
          docker build -f recipes/dotnet_core/Dockerfile -t eclipse/dotnet_core recipes/dotnet_core
        else
          docker build -f recipes/dotnet_core/Dockerfile --cache-from eclipse/dotnet_core -t eclipse/dotnet_core recipes/dotnet_core
        fi
      displayName: "Building eclipse/dotnet_core"
    - script: docker push eclipse/dotnet_core
      displayName: "Pushing eclipse/dotnet_core"

### recipes/hadoop-dev/Dockerfile eclipse/hadoop-dev depends on eclipse/ubuntu_jdk8 recipes/ubuntu_jdk8
  - job: "recipes__hadoop__dev__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__ubuntu_jdk8__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/hadoop-dev
        if [[ $? == 0 ]]; then
          docker tag eclipse/hadoop-dev eclipse/hadoop-dev
        else
          docker pull eclipse/hadoop-dev
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/hadoop-dev
        fi
        docker pull eclipse/ubuntu_jdk8
        if [[ $? == 0 ]]; then
          docker tag eclipse/ubuntu_jdk8 eclipse/ubuntu_jdk8
        else
          docker pull eclipse/ubuntu_jdk8
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/ubuntu_jdk8
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/hadoop-dev =~ stack-base ]]; then
          docker build -f recipes/hadoop-dev/Dockerfile -t eclipse/hadoop-dev recipes/hadoop-dev
        else
          docker build -f recipes/hadoop-dev/Dockerfile --cache-from eclipse/hadoop-dev -t eclipse/hadoop-dev recipes/hadoop-dev
        fi
      displayName: "Building eclipse/hadoop-dev"
    - script: docker push eclipse/hadoop-dev
      displayName: "Pushing eclipse/hadoop-dev"

### recipes/hugo/0.54.0-debian/Dockerfile eclipse/hugo:0.54.0-debian depends on eclipse/stack-base:debian recipes/stack-base/debian
  - job: "recipes__hugo__0__54__0__debian__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__stack__base__debian__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/hugo:0.54.0-debian
        if [[ $? == 0 ]]; then
          docker tag eclipse/hugo:0.54.0-debian eclipse/hugo:0.54.0-debian
        else
          docker pull eclipse/hugo:0.54.0-debian
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/hugo:0.54.0-debian
        fi
        docker pull eclipse/stack-base:debian
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:debian eclipse/stack-base:debian
        else
          docker pull eclipse/stack-base:debian
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:debian
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/hugo:0.54.0-debian =~ stack-base ]]; then
          docker build -f recipes/hugo/0.54.0-debian/Dockerfile -t eclipse/hugo:0.54.0-debian recipes/hugo/0.54.0-debian
        else
          docker build -f recipes/hugo/0.54.0-debian/Dockerfile --cache-from eclipse/hugo:0.54.0-debian -t eclipse/hugo:0.54.0-debian recipes/hugo/0.54.0-debian
        fi
      displayName: "Building eclipse/hugo:0.54.0-debian"
    - script: docker push eclipse/hugo:0.54.0-debian
      displayName: "Pushing eclipse/hugo:0.54.0-debian"

### recipes/hugo/0.54.0-ubuntu/Dockerfile eclipse/hugo:0.54.0-ubuntu depends on eclipse/stack-base:ubuntu recipes/stack-base/ubuntu
  - job: "recipes__hugo__0__54__0__ubuntu__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__stack__base__ubuntu__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/hugo:0.54.0-ubuntu
        if [[ $? == 0 ]]; then
          docker tag eclipse/hugo:0.54.0-ubuntu eclipse/hugo:0.54.0-ubuntu
        else
          docker pull eclipse/hugo:0.54.0-ubuntu
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/hugo:0.54.0-ubuntu
        fi
        docker pull eclipse/stack-base:ubuntu
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:ubuntu eclipse/stack-base:ubuntu
        else
          docker pull eclipse/stack-base:ubuntu
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:ubuntu
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/hugo:0.54.0-ubuntu =~ stack-base ]]; then
          docker build -f recipes/hugo/0.54.0-ubuntu/Dockerfile -t eclipse/hugo:0.54.0-ubuntu recipes/hugo/0.54.0-ubuntu
        else
          docker build -f recipes/hugo/0.54.0-ubuntu/Dockerfile --cache-from eclipse/hugo:0.54.0-ubuntu -t eclipse/hugo:0.54.0-ubuntu recipes/hugo/0.54.0-ubuntu
        fi
      displayName: "Building eclipse/hugo:0.54.0-ubuntu"
    - script: docker push eclipse/hugo:0.54.0-ubuntu
      displayName: "Pushing eclipse/hugo:0.54.0-ubuntu"

### recipes/hugo/debian/Dockerfile eclipse/hugo:debian depends on eclipse/stack-base:debian recipes/stack-base/debian
  - job: "recipes__hugo__debian__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__stack__base__debian__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/hugo:debian
        if [[ $? == 0 ]]; then
          docker tag eclipse/hugo:debian eclipse/hugo:debian
        else
          docker pull eclipse/hugo:debian
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/hugo:debian
        fi
        docker pull eclipse/stack-base:debian
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:debian eclipse/stack-base:debian
        else
          docker pull eclipse/stack-base:debian
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:debian
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/hugo:debian =~ stack-base ]]; then
          docker build -f recipes/hugo/debian/Dockerfile -t eclipse/hugo:debian recipes/hugo/debian
        else
          docker build -f recipes/hugo/debian/Dockerfile --cache-from eclipse/hugo:debian -t eclipse/hugo:debian recipes/hugo/debian
        fi
      displayName: "Building eclipse/hugo:debian"
    - script: docker push eclipse/hugo:debian
      displayName: "Pushing eclipse/hugo:debian"

### recipes/hugo/ubuntu/Dockerfile eclipse/hugo:ubuntu depends on eclipse/stack-base:ubuntu recipes/stack-base/ubuntu
  - job: "recipes__hugo__ubuntu__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__stack__base__ubuntu__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/hugo:ubuntu
        if [[ $? == 0 ]]; then
          docker tag eclipse/hugo:ubuntu eclipse/hugo:ubuntu
        else
          docker pull eclipse/hugo:ubuntu
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/hugo:ubuntu
        fi
        docker pull eclipse/stack-base:ubuntu
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:ubuntu eclipse/stack-base:ubuntu
        else
          docker pull eclipse/stack-base:ubuntu
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:ubuntu
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/hugo:ubuntu =~ stack-base ]]; then
          docker build -f recipes/hugo/ubuntu/Dockerfile -t eclipse/hugo:ubuntu recipes/hugo/ubuntu
        else
          docker build -f recipes/hugo/ubuntu/Dockerfile --cache-from eclipse/hugo:ubuntu -t eclipse/hugo:ubuntu recipes/hugo/ubuntu
        fi
      displayName: "Building eclipse/hugo:ubuntu"
    - script: docker push eclipse/hugo:ubuntu
      displayName: "Pushing eclipse/hugo:ubuntu"

### recipes/kotlin/Dockerfile eclipse/kotlin depends on eclipse/stack-base:ubuntu recipes/stack-base/ubuntu
  - job: "recipes__kotlin__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__stack__base__ubuntu__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/kotlin
        if [[ $? == 0 ]]; then
          docker tag eclipse/kotlin eclipse/kotlin
        else
          docker pull eclipse/kotlin
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/kotlin
        fi
        docker pull eclipse/stack-base:ubuntu
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:ubuntu eclipse/stack-base:ubuntu
        else
          docker pull eclipse/stack-base:ubuntu
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:ubuntu
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/kotlin =~ stack-base ]]; then
          docker build -f recipes/kotlin/Dockerfile -t eclipse/kotlin recipes/kotlin
        else
          docker build -f recipes/kotlin/Dockerfile --cache-from eclipse/kotlin -t eclipse/kotlin recipes/kotlin
        fi
      displayName: "Building eclipse/kotlin"
    - script: docker push eclipse/kotlin
      displayName: "Pushing eclipse/kotlin"

### recipes/meteor/Dockerfile eclipse/meteor depends on eclipse/stack-base:ubuntu recipes/stack-base/ubuntu
  - job: "recipes__meteor__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__stack__base__ubuntu__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/meteor
        if [[ $? == 0 ]]; then
          docker tag eclipse/meteor eclipse/meteor
        else
          docker pull eclipse/meteor
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/meteor
        fi
        docker pull eclipse/stack-base:ubuntu
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:ubuntu eclipse/stack-base:ubuntu
        else
          docker pull eclipse/stack-base:ubuntu
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:ubuntu
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/meteor =~ stack-base ]]; then
          docker build -f recipes/meteor/Dockerfile -t eclipse/meteor recipes/meteor
        else
          docker build -f recipes/meteor/Dockerfile --cache-from eclipse/meteor -t eclipse/meteor recipes/meteor
        fi
      displayName: "Building eclipse/meteor"
    - script: docker push eclipse/meteor
      displayName: "Pushing eclipse/meteor"

### recipes/mysql/Dockerfile eclipse/mysql depends on mysql:5.7 mysql/5.7
  - job: "recipes__mysql__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/mysql
        if [[ $? == 0 ]]; then
          docker tag eclipse/mysql eclipse/mysql
        else
          docker pull eclipse/mysql
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/mysql
        fi
        docker pull mysql:5.7
        if [[ $? == 0 ]]; then
          docker tag mysql:5.7 mysql:5.7
        else
          docker pull mysql:5.7
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch mysql:5.7
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/mysql =~ stack-base ]]; then
          docker build -f recipes/mysql/Dockerfile -t eclipse/mysql recipes/mysql
        else
          docker build -f recipes/mysql/Dockerfile --cache-from eclipse/mysql -t eclipse/mysql recipes/mysql
        fi
      displayName: "Building eclipse/mysql"
    - script: docker push eclipse/mysql
      displayName: "Pushing eclipse/mysql"

### recipes/node/Dockerfile eclipse/node depends on eclipse/stack-base:debian recipes/stack-base/debian
  - job: "recipes__node__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__stack__base__debian__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/node
        if [[ $? == 0 ]]; then
          docker tag eclipse/node eclipse/node
        else
          docker pull eclipse/node
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/node
        fi
        docker pull eclipse/stack-base:debian
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:debian eclipse/stack-base:debian
        else
          docker pull eclipse/stack-base:debian
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:debian
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/node =~ stack-base ]]; then
          docker build -f recipes/node/Dockerfile -t eclipse/node recipes/node
        else
          docker build -f recipes/node/Dockerfile --cache-from eclipse/node -t eclipse/node recipes/node
        fi
      displayName: "Building eclipse/node"
    - script: docker push eclipse/node
      displayName: "Pushing eclipse/node"

### recipes/php/5.6/Dockerfile eclipse/php:5.6 depends on eclipse/stack-base:debian-jessie recipes/stack-base/debian-jessie
  - job: "recipes__php__5__6__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__stack__base__debian__jessie__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/php:5.6
        if [[ $? == 0 ]]; then
          docker tag eclipse/php:5.6 eclipse/php:5.6
        else
          docker pull eclipse/php:5.6
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/php:5.6
        fi
        docker pull eclipse/stack-base:debian-jessie
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:debian-jessie eclipse/stack-base:debian-jessie
        else
          docker pull eclipse/stack-base:debian-jessie
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:debian-jessie
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/php:5.6 =~ stack-base ]]; then
          docker build -f recipes/php/5.6/Dockerfile -t eclipse/php:5.6 recipes/php/5.6
        else
          docker build -f recipes/php/5.6/Dockerfile --cache-from eclipse/php:5.6 -t eclipse/php:5.6 recipes/php/5.6
        fi
      displayName: "Building eclipse/php:5.6"
    - script: docker push eclipse/php:5.6
      displayName: "Pushing eclipse/php:5.6"

### recipes/php/Dockerfile eclipse/php depends on eclipse/stack-base:ubuntu recipes/stack-base/ubuntu
  - job: "recipes__php__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__stack__base__ubuntu__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/php
        if [[ $? == 0 ]]; then
          docker tag eclipse/php eclipse/php
        else
          docker pull eclipse/php
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/php
        fi
        docker pull eclipse/stack-base:ubuntu
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:ubuntu eclipse/stack-base:ubuntu
        else
          docker pull eclipse/stack-base:ubuntu
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:ubuntu
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/php =~ stack-base ]]; then
          docker build -f recipes/php/Dockerfile -t eclipse/php recipes/php
        else
          docker build -f recipes/php/Dockerfile --cache-from eclipse/php -t eclipse/php recipes/php
        fi
      displayName: "Building eclipse/php"
    - script: docker push eclipse/php
      displayName: "Pushing eclipse/php"

### recipes/php/gae/Dockerfile eclipse/php:gae depends on eclipse/php recipes/php
  - job: "recipes__php__gae__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__php__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/php:gae
        if [[ $? == 0 ]]; then
          docker tag eclipse/php:gae eclipse/php:gae
        else
          docker pull eclipse/php:gae
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/php:gae
        fi
        docker pull eclipse/php
        if [[ $? == 0 ]]; then
          docker tag eclipse/php eclipse/php
        else
          docker pull eclipse/php
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/php
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/php:gae =~ stack-base ]]; then
          docker build -f recipes/php/gae/Dockerfile -t eclipse/php:gae recipes/php/gae
        else
          docker build -f recipes/php/gae/Dockerfile --cache-from eclipse/php:gae -t eclipse/php:gae recipes/php/gae
        fi
      displayName: "Building eclipse/php:gae"
    - script: docker push eclipse/php:gae
      displayName: "Pushing eclipse/php:gae"

### recipes/php/laravel/Dockerfile eclipse/php:laravel depends on eclipse/php recipes/php
  - job: "recipes__php__laravel__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__php__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/php:laravel
        if [[ $? == 0 ]]; then
          docker tag eclipse/php:laravel eclipse/php:laravel
        else
          docker pull eclipse/php:laravel
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/php:laravel
        fi
        docker pull eclipse/php
        if [[ $? == 0 ]]; then
          docker tag eclipse/php eclipse/php
        else
          docker pull eclipse/php
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/php
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/php:laravel =~ stack-base ]]; then
          docker build -f recipes/php/laravel/Dockerfile -t eclipse/php:laravel recipes/php/laravel
        else
          docker build -f recipes/php/laravel/Dockerfile --cache-from eclipse/php:laravel -t eclipse/php:laravel recipes/php/laravel
        fi
      displayName: "Building eclipse/php:laravel"
    - script: docker push eclipse/php:laravel
      displayName: "Pushing eclipse/php:laravel"

### recipes/platformio/Dockerfile eclipse/platformio depends on eclipse/ubuntu_python:2.7 recipes/ubuntu_python/2.7
  - job: "recipes__platformio__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__ubuntu_python__2__7__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/platformio
        if [[ $? == 0 ]]; then
          docker tag eclipse/platformio eclipse/platformio
        else
          docker pull eclipse/platformio
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/platformio
        fi
        docker pull eclipse/ubuntu_python:2.7
        if [[ $? == 0 ]]; then
          docker tag eclipse/ubuntu_python:2.7 eclipse/ubuntu_python:2.7
        else
          docker pull eclipse/ubuntu_python:2.7
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/ubuntu_python:2.7
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/platformio =~ stack-base ]]; then
          docker build -f recipes/platformio/Dockerfile -t eclipse/platformio recipes/platformio
        else
          docker build -f recipes/platformio/Dockerfile --cache-from eclipse/platformio -t eclipse/platformio recipes/platformio
        fi
      displayName: "Building eclipse/platformio"
    - script: docker push eclipse/platformio
      displayName: "Pushing eclipse/platformio"

### recipes/ruby_rails/Dockerfile eclipse/ruby_rails depends on eclipse/stack-base:ubuntu recipes/stack-base/ubuntu
  - job: "recipes__ruby_rails__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__stack__base__ubuntu__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/ruby_rails
        if [[ $? == 0 ]]; then
          docker tag eclipse/ruby_rails eclipse/ruby_rails
        else
          docker pull eclipse/ruby_rails
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/ruby_rails
        fi
        docker pull eclipse/stack-base:ubuntu
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:ubuntu eclipse/stack-base:ubuntu
        else
          docker pull eclipse/stack-base:ubuntu
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:ubuntu
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/ruby_rails =~ stack-base ]]; then
          docker build -f recipes/ruby_rails/Dockerfile -t eclipse/ruby_rails recipes/ruby_rails
        else
          docker build -f recipes/ruby_rails/Dockerfile --cache-from eclipse/ruby_rails -t eclipse/ruby_rails recipes/ruby_rails
        fi
      displayName: "Building eclipse/ruby_rails"
    - script: docker push eclipse/ruby_rails
      displayName: "Pushing eclipse/ruby_rails"

### recipes/sails/Dockerfile eclipse/sails depends on eclipse/node recipes/node
  - job: "recipes__sails__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__node__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/sails
        if [[ $? == 0 ]]; then
          docker tag eclipse/sails eclipse/sails
        else
          docker pull eclipse/sails
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/sails
        fi
        docker pull eclipse/node
        if [[ $? == 0 ]]; then
          docker tag eclipse/node eclipse/node
        else
          docker pull eclipse/node
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/node
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/sails =~ stack-base ]]; then
          docker build -f recipes/sails/Dockerfile -t eclipse/sails recipes/sails
        else
          docker build -f recipes/sails/Dockerfile --cache-from eclipse/sails -t eclipse/sails recipes/sails
        fi
      displayName: "Building eclipse/sails"
    - script: docker push eclipse/sails
      displayName: "Pushing eclipse/sails"

### recipes/selenium/Dockerfile eclipse/selenium depends on eclipse/stack-base:ubuntu recipes/stack-base/ubuntu
  - job: "recipes__selenium__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__stack__base__ubuntu__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/selenium
        if [[ $? == 0 ]]; then
          docker tag eclipse/selenium eclipse/selenium
        else
          docker pull eclipse/selenium
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/selenium
        fi
        docker pull eclipse/stack-base:ubuntu
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:ubuntu eclipse/stack-base:ubuntu
        else
          docker pull eclipse/stack-base:ubuntu
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:ubuntu
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/selenium =~ stack-base ]]; then
          docker build -f recipes/selenium/Dockerfile -t eclipse/selenium recipes/selenium
        else
          docker build -f recipes/selenium/Dockerfile --cache-from eclipse/selenium -t eclipse/selenium recipes/selenium
        fi
      displayName: "Building eclipse/selenium"
    - script: docker push eclipse/selenium
      displayName: "Pushing eclipse/selenium"

### recipes/stack-base/centos/Dockerfile eclipse/stack-base:centos depends on registry.centos.org/centos/centos registry.centos.org/centos/centos
  - job: "recipes__stack__base__centos__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/stack-base:centos
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:centos eclipse/stack-base:centos
        else
          docker pull eclipse/stack-base:centos
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:centos
        fi
        docker pull registry.centos.org/centos/centos
        if [[ $? == 0 ]]; then
          docker tag registry.centos.org/centos/centos registry.centos.org/centos/centos
        else
          docker pull registry.centos.org/centos/centos
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch registry.centos.org/centos/centos
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/stack-base:centos =~ stack-base ]]; then
          docker build -f recipes/stack-base/centos/Dockerfile -t eclipse/stack-base:centos recipes/stack-base/centos
        else
          docker build -f recipes/stack-base/centos/Dockerfile --cache-from eclipse/stack-base:centos -t eclipse/stack-base:centos recipes/stack-base/centos
        fi
      displayName: "Building eclipse/stack-base:centos"
    - script: docker push eclipse/stack-base:centos
      displayName: "Pushing eclipse/stack-base:centos"

### recipes/stack-base/debian/Dockerfile eclipse/stack-base:debian depends on debian:stretch debian/stretch
  - job: "recipes__stack__base__debian__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/stack-base:debian
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:debian eclipse/stack-base:debian
        else
          docker pull eclipse/stack-base:debian
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:debian
        fi
        docker pull debian:stretch
        if [[ $? == 0 ]]; then
          docker tag debian:stretch debian:stretch
        else
          docker pull debian:stretch
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch debian:stretch
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/stack-base:debian =~ stack-base ]]; then
          docker build -f recipes/stack-base/debian/Dockerfile -t eclipse/stack-base:debian recipes/stack-base/debian
        else
          docker build -f recipes/stack-base/debian/Dockerfile --cache-from eclipse/stack-base:debian -t eclipse/stack-base:debian recipes/stack-base/debian
        fi
      displayName: "Building eclipse/stack-base:debian"
    - script: docker push eclipse/stack-base:debian
      displayName: "Pushing eclipse/stack-base:debian"

### recipes/stack-base/debian-jessie/Dockerfile eclipse/stack-base:debian-jessie depends on debian:jessie-backports debian/jessie-backports
  - job: "recipes__stack__base__debian__jessie__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/stack-base:debian-jessie
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:debian-jessie eclipse/stack-base:debian-jessie
        else
          docker pull eclipse/stack-base:debian-jessie
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:debian-jessie
        fi
        docker pull debian:jessie-backports
        if [[ $? == 0 ]]; then
          docker tag debian:jessie-backports debian:jessie-backports
        else
          docker pull debian:jessie-backports
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch debian:jessie-backports
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/stack-base:debian-jessie =~ stack-base ]]; then
          docker build -f recipes/stack-base/debian-jessie/Dockerfile -t eclipse/stack-base:debian-jessie recipes/stack-base/debian-jessie
        else
          docker build -f recipes/stack-base/debian-jessie/Dockerfile --cache-from eclipse/stack-base:debian-jessie -t eclipse/stack-base:debian-jessie recipes/stack-base/debian-jessie
        fi
      displayName: "Building eclipse/stack-base:debian-jessie"
    - script: docker push eclipse/stack-base:debian-jessie
      displayName: "Pushing eclipse/stack-base:debian-jessie"

### recipes/stack-base/debian-stretch/Dockerfile eclipse/stack-base:debian-stretch depends on debian:stretch debian/stretch
  - job: "recipes__stack__base__debian__stretch__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/stack-base:debian-stretch
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:debian-stretch eclipse/stack-base:debian-stretch
        else
          docker pull eclipse/stack-base:debian-stretch
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:debian-stretch
        fi
        docker pull debian:stretch
        if [[ $? == 0 ]]; then
          docker tag debian:stretch debian:stretch
        else
          docker pull debian:stretch
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch debian:stretch
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/stack-base:debian-stretch =~ stack-base ]]; then
          docker build -f recipes/stack-base/debian-stretch/Dockerfile -t eclipse/stack-base:debian-stretch recipes/stack-base/debian-stretch
        else
          docker build -f recipes/stack-base/debian-stretch/Dockerfile --cache-from eclipse/stack-base:debian-stretch -t eclipse/stack-base:debian-stretch recipes/stack-base/debian-stretch
        fi
      displayName: "Building eclipse/stack-base:debian-stretch"
    - script: docker push eclipse/stack-base:debian-stretch
      displayName: "Pushing eclipse/stack-base:debian-stretch"

### recipes/stack-base/ubuntu/Dockerfile eclipse/stack-base:ubuntu depends on ubuntu:16.04 ubuntu/16.04
  - job: "recipes__stack__base__ubuntu__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/stack-base:ubuntu
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:ubuntu eclipse/stack-base:ubuntu
        else
          docker pull eclipse/stack-base:ubuntu
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:ubuntu
        fi
        docker pull ubuntu:16.04
        if [[ $? == 0 ]]; then
          docker tag ubuntu:16.04 ubuntu:16.04
        else
          docker pull ubuntu:16.04
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch ubuntu:16.04
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/stack-base:ubuntu =~ stack-base ]]; then
          docker build -f recipes/stack-base/ubuntu/Dockerfile -t eclipse/stack-base:ubuntu recipes/stack-base/ubuntu
        else
          docker build -f recipes/stack-base/ubuntu/Dockerfile --cache-from eclipse/stack-base:ubuntu -t eclipse/stack-base:ubuntu recipes/stack-base/ubuntu
        fi
      displayName: "Building eclipse/stack-base:ubuntu"
    - script: docker push eclipse/stack-base:ubuntu
      displayName: "Pushing eclipse/stack-base:ubuntu"

### recipes/ubuntu_go/Dockerfile eclipse/ubuntu_go depends on eclipse/stack-base:ubuntu recipes/stack-base/ubuntu
  - job: "recipes__ubuntu_go__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__stack__base__ubuntu__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/ubuntu_go
        if [[ $? == 0 ]]; then
          docker tag eclipse/ubuntu_go eclipse/ubuntu_go
        else
          docker pull eclipse/ubuntu_go
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/ubuntu_go
        fi
        docker pull eclipse/stack-base:ubuntu
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:ubuntu eclipse/stack-base:ubuntu
        else
          docker pull eclipse/stack-base:ubuntu
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:ubuntu
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/ubuntu_go =~ stack-base ]]; then
          docker build -f recipes/ubuntu_go/Dockerfile -t eclipse/ubuntu_go recipes/ubuntu_go
        else
          docker build -f recipes/ubuntu_go/Dockerfile --cache-from eclipse/ubuntu_go -t eclipse/ubuntu_go recipes/ubuntu_go
        fi
      displayName: "Building eclipse/ubuntu_go"
    - script: docker push eclipse/ubuntu_go
      displayName: "Pushing eclipse/ubuntu_go"

### recipes/ubuntu_gradle/Dockerfile eclipse/ubuntu_gradle depends on eclipse/ubuntu_jdk8 recipes/ubuntu_jdk8
  - job: "recipes__ubuntu_gradle__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__ubuntu_jdk8__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/ubuntu_gradle
        if [[ $? == 0 ]]; then
          docker tag eclipse/ubuntu_gradle eclipse/ubuntu_gradle
        else
          docker pull eclipse/ubuntu_gradle
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/ubuntu_gradle
        fi
        docker pull eclipse/ubuntu_jdk8
        if [[ $? == 0 ]]; then
          docker tag eclipse/ubuntu_jdk8 eclipse/ubuntu_jdk8
        else
          docker pull eclipse/ubuntu_jdk8
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/ubuntu_jdk8
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/ubuntu_gradle =~ stack-base ]]; then
          docker build -f recipes/ubuntu_gradle/Dockerfile -t eclipse/ubuntu_gradle recipes/ubuntu_gradle
        else
          docker build -f recipes/ubuntu_gradle/Dockerfile --cache-from eclipse/ubuntu_gradle -t eclipse/ubuntu_gradle recipes/ubuntu_gradle
        fi
      displayName: "Building eclipse/ubuntu_gradle"
    - script: docker push eclipse/ubuntu_gradle
      displayName: "Pushing eclipse/ubuntu_gradle"

### recipes/ubuntu_jdk8/Dockerfile eclipse/ubuntu_jdk8 depends on eclipse/stack-base:ubuntu recipes/stack-base/ubuntu
  - job: "recipes__ubuntu_jdk8__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__stack__base__ubuntu__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/ubuntu_jdk8
        if [[ $? == 0 ]]; then
          docker tag eclipse/ubuntu_jdk8 eclipse/ubuntu_jdk8
        else
          docker pull eclipse/ubuntu_jdk8
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/ubuntu_jdk8
        fi
        docker pull eclipse/stack-base:ubuntu
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:ubuntu eclipse/stack-base:ubuntu
        else
          docker pull eclipse/stack-base:ubuntu
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:ubuntu
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/ubuntu_jdk8 =~ stack-base ]]; then
          docker build -f recipes/ubuntu_jdk8/Dockerfile -t eclipse/ubuntu_jdk8 recipes/ubuntu_jdk8
        else
          docker build -f recipes/ubuntu_jdk8/Dockerfile --cache-from eclipse/ubuntu_jdk8 -t eclipse/ubuntu_jdk8 recipes/ubuntu_jdk8
        fi
      displayName: "Building eclipse/ubuntu_jdk8"
    - script: docker push eclipse/ubuntu_jdk8
      displayName: "Pushing eclipse/ubuntu_jdk8"

### recipes/ubuntu_python/2.7/Dockerfile eclipse/ubuntu_python:2.7 depends on eclipse/stack-base:ubuntu recipes/stack-base/ubuntu
  - job: "recipes__ubuntu_python__2__7__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__stack__base__ubuntu__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/ubuntu_python:2.7
        if [[ $? == 0 ]]; then
          docker tag eclipse/ubuntu_python:2.7 eclipse/ubuntu_python:2.7
        else
          docker pull eclipse/ubuntu_python:2.7
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/ubuntu_python:2.7
        fi
        docker pull eclipse/stack-base:ubuntu
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:ubuntu eclipse/stack-base:ubuntu
        else
          docker pull eclipse/stack-base:ubuntu
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:ubuntu
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/ubuntu_python:2.7 =~ stack-base ]]; then
          docker build -f recipes/ubuntu_python/2.7/Dockerfile -t eclipse/ubuntu_python:2.7 recipes/ubuntu_python/2.7
        else
          docker build -f recipes/ubuntu_python/2.7/Dockerfile --cache-from eclipse/ubuntu_python:2.7 -t eclipse/ubuntu_python:2.7 recipes/ubuntu_python/2.7
        fi
      displayName: "Building eclipse/ubuntu_python:2.7"
    - script: docker push eclipse/ubuntu_python:2.7
      displayName: "Pushing eclipse/ubuntu_python:2.7"

### recipes/ubuntu_python/Dockerfile eclipse/ubuntu_python depends on eclipse/stack-base:ubuntu recipes/stack-base/ubuntu
  - job: "recipes__ubuntu_python__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__stack__base__ubuntu__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/ubuntu_python
        if [[ $? == 0 ]]; then
          docker tag eclipse/ubuntu_python eclipse/ubuntu_python
        else
          docker pull eclipse/ubuntu_python
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/ubuntu_python
        fi
        docker pull eclipse/stack-base:ubuntu
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:ubuntu eclipse/stack-base:ubuntu
        else
          docker pull eclipse/stack-base:ubuntu
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:ubuntu
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/ubuntu_python =~ stack-base ]]; then
          docker build -f recipes/ubuntu_python/Dockerfile -t eclipse/ubuntu_python recipes/ubuntu_python
        else
          docker build -f recipes/ubuntu_python/Dockerfile --cache-from eclipse/ubuntu_python -t eclipse/ubuntu_python recipes/ubuntu_python
        fi
      displayName: "Building eclipse/ubuntu_python"
    - script: docker push eclipse/ubuntu_python
      displayName: "Pushing eclipse/ubuntu_python"

### recipes/ubuntu_python/gae_python2.7/Dockerfile eclipse/ubuntu_python:gae_python2.7 depends on eclipse/stack-base:debian recipes/stack-base/debian
  - job: "recipes__ubuntu_python__gae_python2__7__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__stack__base__debian__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/ubuntu_python:gae_python2.7
        if [[ $? == 0 ]]; then
          docker tag eclipse/ubuntu_python:gae_python2.7 eclipse/ubuntu_python:gae_python2.7
        else
          docker pull eclipse/ubuntu_python:gae_python2.7
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/ubuntu_python:gae_python2.7
        fi
        docker pull eclipse/stack-base:debian
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:debian eclipse/stack-base:debian
        else
          docker pull eclipse/stack-base:debian
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:debian
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/ubuntu_python:gae_python2.7 =~ stack-base ]]; then
          docker build -f recipes/ubuntu_python/gae_python2.7/Dockerfile -t eclipse/ubuntu_python:gae_python2.7 recipes/ubuntu_python/gae_python2.7
        else
          docker build -f recipes/ubuntu_python/gae_python2.7/Dockerfile --cache-from eclipse/ubuntu_python:gae_python2.7 -t eclipse/ubuntu_python:gae_python2.7 recipes/ubuntu_python/gae_python2.7
        fi
      displayName: "Building eclipse/ubuntu_python:gae_python2.7"
    - script: docker push eclipse/ubuntu_python:gae_python2.7
      displayName: "Pushing eclipse/ubuntu_python:gae_python2.7"

### recipes/ubuntu_python/gae_python3/Dockerfile eclipse/ubuntu_python:gae_python3 depends on eclipse/stack-base:debian recipes/stack-base/debian
  - job: "recipes__ubuntu_python__gae_python3__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__stack__base__debian__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/ubuntu_python:gae_python3
        if [[ $? == 0 ]]; then
          docker tag eclipse/ubuntu_python:gae_python3 eclipse/ubuntu_python:gae_python3
        else
          docker pull eclipse/ubuntu_python:gae_python3
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/ubuntu_python:gae_python3
        fi
        docker pull eclipse/stack-base:debian
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:debian eclipse/stack-base:debian
        else
          docker pull eclipse/stack-base:debian
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:debian
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/ubuntu_python:gae_python3 =~ stack-base ]]; then
          docker build -f recipes/ubuntu_python/gae_python3/Dockerfile -t eclipse/ubuntu_python:gae_python3 recipes/ubuntu_python/gae_python3
        else
          docker build -f recipes/ubuntu_python/gae_python3/Dockerfile --cache-from eclipse/ubuntu_python:gae_python3 -t eclipse/ubuntu_python:gae_python3 recipes/ubuntu_python/gae_python3
        fi
      displayName: "Building eclipse/ubuntu_python:gae_python3"
    - script: docker push eclipse/ubuntu_python:gae_python3
      displayName: "Pushing eclipse/ubuntu_python:gae_python3"

### recipes/ubuntu_rlang/Dockerfile eclipse/ubuntu_rlang depends on eclipse/stack-base:ubuntu recipes/stack-base/ubuntu
  - job: "recipes__ubuntu_rlang__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__stack__base__ubuntu__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/ubuntu_rlang
        if [[ $? == 0 ]]; then
          docker tag eclipse/ubuntu_rlang eclipse/ubuntu_rlang
        else
          docker pull eclipse/ubuntu_rlang
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/ubuntu_rlang
        fi
        docker pull eclipse/stack-base:ubuntu
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:ubuntu eclipse/stack-base:ubuntu
        else
          docker pull eclipse/stack-base:ubuntu
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:ubuntu
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/ubuntu_rlang =~ stack-base ]]; then
          docker build -f recipes/ubuntu_rlang/Dockerfile -t eclipse/ubuntu_rlang recipes/ubuntu_rlang
        else
          docker build -f recipes/ubuntu_rlang/Dockerfile --cache-from eclipse/ubuntu_rlang -t eclipse/ubuntu_rlang recipes/ubuntu_rlang
        fi
      displayName: "Building eclipse/ubuntu_rlang"
    - script: docker push eclipse/ubuntu_rlang
      displayName: "Pushing eclipse/ubuntu_rlang"

### recipes/ubuntu_wildfly8/Dockerfile eclipse/ubuntu_wildfly8 depends on eclipse/stack-base:ubuntu recipes/stack-base/ubuntu
  - job: "recipes__ubuntu_wildfly8__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__stack__base__ubuntu__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/ubuntu_wildfly8
        if [[ $? == 0 ]]; then
          docker tag eclipse/ubuntu_wildfly8 eclipse/ubuntu_wildfly8
        else
          docker pull eclipse/ubuntu_wildfly8
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/ubuntu_wildfly8
        fi
        docker pull eclipse/stack-base:ubuntu
        if [[ $? == 0 ]]; then
          docker tag eclipse/stack-base:ubuntu eclipse/stack-base:ubuntu
        else
          docker pull eclipse/stack-base:ubuntu
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/stack-base:ubuntu
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/ubuntu_wildfly8 =~ stack-base ]]; then
          docker build -f recipes/ubuntu_wildfly8/Dockerfile -t eclipse/ubuntu_wildfly8 recipes/ubuntu_wildfly8
        else
          docker build -f recipes/ubuntu_wildfly8/Dockerfile --cache-from eclipse/ubuntu_wildfly8 -t eclipse/ubuntu_wildfly8 recipes/ubuntu_wildfly8
        fi
      displayName: "Building eclipse/ubuntu_wildfly8"
    - script: docker push eclipse/ubuntu_wildfly8
      displayName: "Pushing eclipse/ubuntu_wildfly8"

### recipes/x11_vnc/Dockerfile eclipse/x11_vnc depends on eclipse/ubuntu_jdk8 recipes/ubuntu_jdk8
  - job: "recipes__x11_vnc__Dockerfile"
    timeoutInMinutes: 0
    pool:
      vmImage: 'Ubuntu 16.04'
    dependsOn: "recipes__ubuntu_jdk8__Dockerfile"
    steps:

    - task: Docker@1
      displayName: 'Login to ACR.'
      inputs:
        command: login
        dockerRegistryEndpoint: camino.azurecr.io
        containerregistrytype: Container Registry

    - script: |
        set +e
        docker pull eclipse/x11_vnc
        if [[ $? == 0 ]]; then
          docker tag eclipse/x11_vnc eclipse/x11_vnc
        else
          docker pull eclipse/x11_vnc
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/x11_vnc
        fi
        docker pull eclipse/ubuntu_jdk8
        if [[ $? == 0 ]]; then
          docker tag eclipse/ubuntu_jdk8 eclipse/ubuntu_jdk8
        else
          docker pull eclipse/ubuntu_jdk8
        fi
        if [[ $? != 0 ]]; then
          docker tag scratch eclipse/ubuntu_jdk8
        fi
        exit 0
      continueOnError: true
      failOnStderr: false
      displayName: "Pulling cache. (errors will be ignored)"
    - script: |
        if [[ eclipse/x11_vnc =~ stack-base ]]; then
          docker build -f recipes/x11_vnc/Dockerfile -t eclipse/x11_vnc recipes/x11_vnc
        else
          docker build -f recipes/x11_vnc/Dockerfile --cache-from eclipse/x11_vnc -t eclipse/x11_vnc recipes/x11_vnc
        fi
      displayName: "Building eclipse/x11_vnc"
    - script: docker push eclipse/x11_vnc
      displayName: "Pushing eclipse/x11_vnc"
